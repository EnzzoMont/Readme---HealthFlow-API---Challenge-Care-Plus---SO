üè• HealthFlow API - Challenge Care Plus
Este projeto consiste em uma API RESTful desenvolvida em .NET 9 e hospedada em infraestrutura On-Premise utilizando o servidor web IIS (Internet Information Services).

O objetivo principal desta entrega para a disciplina de Operating Systems √© demonstrar a configura√ß√£o de ambiente de servidor, deploy de aplica√ß√£o, gerenciamento de permiss√µes de sistema de arquivos e a implementa√ß√£o de uma estrat√©gia de observabilidade em camadas (Logs de Infraestrutura vs. Logs de Aplica√ß√£o).

üë®‚Äçüíª Integrantes do Grupo
Enzo Barbeli - RM554272

Enzzo Monteiro Barros Silva - RM552616

Felipe - RM 554249

Iago - RM 553776

Lucas Garcia - RM554070

Pedro Chaves - RM553988

‚öôÔ∏è Pr√©-requisitos e Ambiente
Para reproduzir este ambiente, √© necess√°rio:

Sistema Operacional: Windows 10, 11 ou Windows Server.

IIS (Internet Information Services): Ativado no Windows.

Runtime: .NET 9.0 Hosting Bundle (Essencial para o IIS processar aplica√ß√µes .NET Core).

üöÄ Passo a Passo da Configura√ß√£o (Deploy)
1. Instala√ß√£o do IIS
Executamos a ativa√ß√£o do servidor web nativo do Windows via PowerShell (Admin) ou Painel de Controle, garantindo a inclus√£o do Console de Gerenciamento.

PowerShell

Enable-WindowsOptionalFeature -Online -FeatureName IIS-WebServerRole -All
2. Configura√ß√£o do C√≥digo (Back-end)
Utilizamos uma Minimal API em C# que simula o registro de atividades de sa√∫de e valida regras de neg√≥cio (ex: horas de sono n√£o podem ser negativas).

C√≥digo Fonte (Program.cs):

C#

var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

// Caminho do Log de Regra de Neg√≥cio
string logPath = @"C:\HealthFlowLogs\app_log.txt";

app.MapGet("/", () => "HealthFlow API Online no IIS - Porta 8081");

app.MapGet("/registrar-sono/{horas}", (int horas) =>
{
    // Valida√ß√£o de Regra de Neg√≥cio
    if (horas < 0)
    {
        string logMsg = $"{DateTime.Now}: ERRO DE NEG√ìCIO - Tentativa de registrar sono negativo: {horas}h.";
        try { File.AppendAllText(logPath, logMsg + Environment.NewLine); }
        catch { /* Ignora erro de disco para n√£o travar request */ }
        
        return Results.BadRequest("Erro: Horas de sono n√£o podem ser negativas.");
    }

    return Results.Ok($"Sucesso: {horas} horas de sono registradas.");
});

app.Run();
3. Publica√ß√£o (Build)
Geramos os bin√°rios otimizados para produ√ß√£o e os alocamos no diret√≥rio padr√£o do IIS.

PowerShell

dotnet publish -o "C:\inetpub\wwwroot\HealthFlow"
4. Configura√ß√£o no IIS Manager
Para garantir isolamento de processos e performance, configuramos:

Application Pool: HealthFlowPool

.NET CLR Version: No Managed Code (Essencial para .NET 5+).

Site: HealthFlow

Porta: 8081 (Para evitar conflitos com a porta 80).

Caminho F√≠sico: C:\inetpub\wwwroot\HealthFlow.

5. Configura√ß√£o de Permiss√µes (Seguran√ßa do SO)
Para que a aplica√ß√£o consiga escrever o Log de Neg√≥cio, foi necess√°rio conceder permiss√£o de escrita explicita na pasta de logs, j√° que o usu√°rio do IIS √© restrito por padr√£o.

Cria√ß√£o da pasta: C:\HealthFlowLogs

Permiss√£o: Full Control para o grupo Todos (ou IIS_IUSRS em ambiente produtivo).

üìä Estrat√©gia de Logs (Observabilidade)
Demonstramos dois n√≠veis distintos de monitoramento exigidos no desafio:

1. Logs de Infraestrutura (IIS)
Monitoram a sa√∫de do servidor web e requisi√ß√µes HTTP.

Localiza√ß√£o: C:\inetpub\logs\LogFiles\W3SVC...

O que registra: Erros de conex√£o, rotas inexistentes (404), Erros internos (500).

Exemplo de Teste: Acessar http://localhost:8081/pagina-inexistente.

Resultado no Log: GET /pagina-inexistente ... 404

2. Logs de Aplica√ß√£o (Regra de Neg√≥cio)
Monitoram o comportamento do usu√°rio e viola√ß√µes de regras l√≥gicas.

Localiza√ß√£o: C:\HealthFlowLogs\app_log.txt

O que registra: Tentativas de burlar regras de sa√∫de (ex: sono negativo).

Exemplo de Teste: Acessar http://localhost:8081/registrar-sono/-5.

Resultado no Browser: 400 Bad Request.

Resultado no Log (Txt): ERRO DE NEG√ìCIO - Tentativa de registrar sono negativo.

‚úÖ Como Testar
Acesse http://localhost:8081 para verificar se a API est√° online.

Acesse http://localhost:8081/registrar-sono/8 para um registro com sucesso (Status 200).

Acesse http://localhost:8081/registrar-sono/-5 para gerar um erro de neg√≥cio e verificar a cria√ß√£o do arquivo de log em C:\HealthFlowLogs.